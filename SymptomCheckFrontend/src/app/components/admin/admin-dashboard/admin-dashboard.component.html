<div class="dashboard-container">
  <!-- Header -->
  <div class="dashboard-header">
    <div class="header-content">
      <div class="header-main">
        <h1 class="dashboard-title">Admin Dashboard</h1>
        <p class="dashboard-subtitle">Welcome back! Here's what's happening today.</p>
      </div>
      <div class="header-meta">
        <span class="current-time">{{ getCurrentTime() }}</span>
        <span class="current-date">{{ getCurrentDate() }}</span>
      </div>
    </div>
    <div class="header-actions">
      <button class="btn-refresh" (click)="refreshData()" [disabled]="isRefreshing" 
              [title]="isRefreshing ? 'Refreshing data...' : 'Refresh dashboard data'">
        <i class="icon-refresh" [class.spinning]="isRefreshing">ğŸ”„</i>
        {{ isRefreshing ? 'Refreshing...' : 'Refresh' }}
      </button>
      <button class="btn-logout" (click)="logout()" title="Logout from admin dashboard">
        <i class="icon-logout">ğŸšª</i>
        Logout
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="loading-spinner"></div>
    <p>Loading dashboard data...</p>
    <div class="loading-progress">
      <div class="progress-bar">
        <div class="progress-fill"></div>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div *ngIf="!isLoading" class="dashboard-content">
    
    <!-- Quick Stats Grid -->
    <div class="stats-grid">
      <!-- Total Users -->
      <div class="stat-card" (click)="navigateTo('users')" role="button" tabindex="0" 
           (keyup.enter)="navigateTo('users')" (keyup.space)="navigateTo('users')">
        <div class="stat-icon user-icon" aria-hidden="true">
          <i class="icon-users">ğŸ‘¥</i>
        </div>
        <div class="stat-content">
          <h3 class="stat-value" [attr.aria-label]="'Total users: ' + dashboardStats.totalUsers">
            {{ dashboardStats.totalUsers | number }}
          </h3>
          <p class="stat-label">Total Users</p>
          <div class="stat-trend positive">
            <i class="icon-trend-up" aria-hidden="true">ğŸ“ˆ</i>
            {{ dashboardStats.newUsersThisWeek }} new this week
          </div>
        </div>
        <div class="stat-arrow">â†’</div>
      </div>

      <!-- Total Doctors -->
      <div class="stat-card" (click)="navigateTo('doctors')" role="button" tabindex="0"
           (keyup.enter)="navigateTo('doctors')" (keyup.space)="navigateTo('doctors')">
        <div class="stat-icon doctor-icon" aria-hidden="true">
          <i class="icon-doctor">ğŸ‘¨â€âš•ï¸</i>
        </div>
        <div class="stat-content">
          <h3 class="stat-value" [attr.aria-label]="'Total doctors: ' + dashboardStats.totalDoctors">
            {{ dashboardStats.totalDoctors | number }}
          </h3>
          <p class="stat-label">Total Doctors</p>
          <div class="stat-trend warning" *ngIf="dashboardStats.pendingDoctors > 0">
            <i class="icon-alert" aria-hidden="true">âš ï¸</i>
            {{ dashboardStats.pendingDoctors }} pending approval
          </div>
          <div class="stat-trend neutral" *ngIf="dashboardStats.pendingDoctors === 0">
            All approved
          </div>
        </div>
        <div class="stat-arrow">â†’</div>
      </div>

      <!-- Total Clinics -->
      <div class="stat-card" (click)="navigateTo('clinics')" role="button" tabindex="0"
           (keyup.enter)="navigateTo('clinics')" (keyup.space)="navigateTo('clinics')">
        <div class="stat-icon clinic-icon" aria-hidden="true">
          <i class="icon-clinic">ğŸ¥</i>
        </div>
        <div class="stat-content">
          <h3 class="stat-value" [attr.aria-label]="'Total clinics: ' + dashboardStats.totalClinics">
            {{ dashboardStats.totalClinics | number }}
          </h3>
          <p class="stat-label">Medical Clinics</p>
          <div class="stat-trend neutral">
            <i class="icon-building" aria-hidden="true">ğŸ¢</i>
            Active facilities
          </div>
        </div>
        <div class="stat-arrow">â†’</div>
      </div>

      <!-- Total Appointments -->
      <div class="stat-card" (click)="navigateTo('appointments')" role="button" tabindex="0"
           (keyup.enter)="navigateTo('appointments')" (keyup.space)="navigateTo('appointments')">
        <div class="stat-icon appointment-icon" aria-hidden="true">
          <i class="icon-calendar">ğŸ“…</i>
        </div>
        <div class="stat-content">
          <h3 class="stat-value" [attr.aria-label]="'Total appointments: ' + dashboardStats.totalAppointments">
            {{ dashboardStats.totalAppointments | number }}
          </h3>
          <p class="stat-label">Total Appointments</p>
          <div class="stat-trend info">
            <i class="icon-today" aria-hidden="true">ğŸ“Œ</i>
            {{ dashboardStats.activeAppointments }} today
          </div>
        </div>
        <div class="stat-arrow">â†’</div>
      </div>

      <!-- Revenue -->
      <div class="stat-card">
        <div class="stat-icon revenue-icon" aria-hidden="true">
          <i class="icon-revenue">ğŸ’°</i>
        </div>
        <div class="stat-content">
          <h3 class="stat-value" [attr.aria-label]="'Total revenue: $' + dashboardStats.totalRevenue">
            ${{ dashboardStats.totalRevenue | number:'1.0-0' }}
          </h3>
          <p class="stat-label">Total Revenue</p>
          <div class="stat-trend positive">
            <i class="icon-trend-up" aria-hidden="true">ğŸ“ˆ</i>
            All time
          </div>
        </div>
      </div>

      <!-- Quick Actions -->
      <div class="stat-card actions-card">
        <h3 class="stat-label">Quick Actions</h3>
        <div class="quick-actions">
          <button class="btn-quick-action" (click)="approveDoctors()" 
                  [disabled]="dashboardStats.pendingDoctors === 0"
                  [title]="dashboardStats.pendingDoctors > 0 ? 'Approve pending doctors' : 'No pending doctors'">
            <i class="icon-approve">âœ…</i>
            Approve Doctors
            <span class="badge" *ngIf="dashboardStats.pendingDoctors > 0" 
                  [attr.aria-label]="dashboardStats.pendingDoctors + ' doctors pending approval'">
              {{ dashboardStats.pendingDoctors }}
            </span>
          </button>
          <button class="btn-quick-action" (click)="viewTodayAppointments()"
                  title="View today's appointments">
            <i class="icon-today">ğŸ“Œ</i>
            Today's Appointments
          </button>
          <button class="btn-quick-action" (click)="manageUsers()"
                  title="Manage all users">
            <i class="icon-users">ğŸ‘¥</i>
            Manage Users
          </button>
        </div>
      </div>
    </div>

    <!-- Charts Section -->
    <div class="charts-section">
      <!-- User Growth Chart -->
      <div class="chart-card">
        <div class="chart-header">
          <div class="chart-title-section">
            <h3>User Growth</h3>
            <span class="chart-subtitle">Monthly user registration trend</span>
          </div>
          <div class="chart-actions">
            <button class="btn-chart-action" title="Download chart data">
              <i>ğŸ“¥</i>
            </button>
            <button class="btn-chart-action" title="View full report">
              <i>ğŸ“Š</i>
            </button>
          </div>
        </div>
        <div class="chart-container-wrapper" [class.loading]="chartLoading">
          <app-bar-growth-chart
            [data]="userGrowthChart.data"
            [categories]="userGrowthChart.categories"
            [chartTitle]="userGrowthChart.title">
          </app-bar-growth-chart>
        </div>
      </div>

      <!-- Appointment Status Chart -->
      <div class="chart-card">
        <div class="chart-header">
          <div class="chart-title-section">
            <h3>Appointment Status</h3>
            <span class="chart-subtitle">Current appointment distribution</span>
          </div>
          <div class="chart-actions">
            <button class="btn-chart-action" title="Download chart data">
              <i>ğŸ“¥</i>
            </button>
          </div>
        </div>
        <div class="chart-container-wrapper" [class.loading]="chartLoading">
          <app-bar-growth-chart
            [data]="appointmentStatusChart.data"
            [categories]="appointmentStatusChart.categories"
            [chartTitle]="appointmentStatusChart.title">
          </app-bar-growth-chart>
        </div>
      </div>

      <!-- Revenue Chart -->
      <div class="chart-card full-width">
        <div class="chart-header">
          <div class="chart-title-section">
            <h3>Revenue Overview</h3>
            <span class="chart-subtitle">Monthly revenue performance</span>
          </div>
          <div class="chart-actions">
            <button class="btn-chart-action" title="Download chart data">
              <i>ğŸ“¥</i>
            </button>
            <button class="btn-chart-action" title="View financial report">
              <i>ğŸ’°</i>
            </button>
          </div>
        </div>
        <div class="chart-container-wrapper" [class.loading]="chartLoading">
          <app-bar-growth-chart
            [data]="revenueChart.data"
            [categories]="revenueChart.categories"
            [chartTitle]="revenueChart.title">
          </app-bar-growth-chart>
        </div>
      </div>
    </div>

    <!-- Recent Activity & System Overview -->
    <div class="bottom-section">
      <!-- Recent Activity -->
      <div class="activity-card">
        <div class="card-header">
          <h3>Recent Activity</h3>
          <button class="btn-view-all" (click)="navigateTo('activity')" title="View all activities">
            View All
          </button>
        </div>
        <div class="activity-list">
          <div *ngFor="let activity of recentActivities; trackBy: trackByActivity" 
               class="activity-item" role="listitem">
            <div class="activity-icon" [class]="'icon-' + activity.type" aria-hidden="true">
              {{ activity.icon }}
            </div>
            <div class="activity-content">
              <p class="activity-message">{{ activity.message }}</p>
              <span class="activity-time">{{ activity.time }}</span>
            </div>
          </div>
        </div>
      </div>

      <!-- System Overview -->
      <div class="system-card">
        <div class="card-header">
          <h3>System Overview</h3>
          <span class="status-indicator online">All Systems Operational</span>
        </div>
        <div class="system-metrics">
          <div class="metric">
            <span class="metric-label">Server Uptime</span>
            <span class="metric-value">99.9%</span>
          </div>
          <div class="metric">
            <span class="metric-label">Response Time</span>
            <span class="metric-value">128ms</span>
          </div>
          <div class="metric">
            <span class="metric-label">Active Sessions</span>
            <span class="metric-value">247</span>
          </div>
          <div class="metric">
            <span class="metric-label">Database Health</span>
            <span class="metric-value positive">Excellent</span>
          </div>
        </div>
        <div class="system-footer">
          <div class="last-update">
            Last updated: {{ getCurrentTime() }}
          </div>
          <button class="btn-system-refresh" (click)="refreshData()" title="Refresh system data">
            <i>ğŸ”„</i>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Debug Panel (Remove in production) -->
  <div class="debug-panel" *ngIf="!isLoading">
    <details>
      <summary>Debug Info</summary>
      <pre>{{ dashboardStats | json }}</pre>
    </details>
  </div>
</div>